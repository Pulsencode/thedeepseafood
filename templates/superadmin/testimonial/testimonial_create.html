{% include "superadmin/layout/header.html" %}
{% load static %}
<!--app-content open-->
<div class="main-content app-content mt-0">
    <div class="side-app">
        <!-- CONTAINER -->
        <div class="main-container container-fluid">
            <!-- PAGE-HEADER -->
            <div class="page-header">
                <h1 class="page-title">Testimonial</h1>
                <div>
                    <a class="btn btn-primary" href="{% url 'list_testimonial' %}"><i class="side-menu__icon fe fe-eye mx-1"></i>View All</a>
                </div>
            </div>
            <!-- PAGE-HEADER END -->
            <!-- ROW OPEN -->
            <form method="post" enctype="multipart/form-data" id="myform">
                {% csrf_token %}
                <div class="row">
                    <div class="col-md-4 col-xl-4 col-12">
                        <div class="card">
                            <div class="card-header">
                                <h4 class="card-title">Add New testimonial Images</h4>
                            </div>
                            <div class="card-body">
                                <div class="row">
                                    <div class="col-lg-12">
                                        <img {% if form.instance.image %}src="{{ form.instance.image.url }}" {% else %}src="" {% endif %}
                                             class="" />
                                        <label class="cabinet center-block">
                                            <figure>
                                                <img src=""
                                                     class="gambar5 img-responsive img-thumbnail5"
                                                     id="item-img-output5" />
                                                <figcaption>
                                                    <i class="fa fa-camera"></i>
                                                </figcaption>
                                            </figure>
                                            {{ form.image }}
                                        </label>
                                    </div>
                                    <input type="hidden" id="cropped-img" name="testi-image">
                                    <!-- Modal content remains unchanged -->
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-8 col-xl-8 col-12">
                        <div class="card">
                            <div class="card-body">
                                <div class="row col-lg-12">
                                    <div class="form-group col-lg-12">
                                        <label for="" class="form-label">Name</label>
                                        {{ form.name }}
                                    </div>
                                    <div class="col-lg-12">
                                        <div class="form-group">
                                            <label for="exampleInputEmail1" class="form-label">Quote</label>
                                            {{ form.quote }}
                                        </div>
                                    </div>
                                    <div class="form-group col-lg-12">
                                        <label for="" class="form-label">Image Alt</label>
                                        {{ form.image_alt }}
                                    </div>
                                    <div class="form-group col-lg-12 col-12">
                                        <button type="submit" class="btn btn-primary mt-4 mb-0" id="submitButton">Submit</button>
                                        <a href="{% url 'list_testimonial' %}" class="btn btn-danger mt-4 mb-0">Cancel</a>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </form>
        </div>
    </div>
</div>
{% include "superadmin/layout/footer.html" %}
<!-- 5 -->
<script>
    // Start upload preview image
    $(".gambar5").attr("src", "https://deepsea.noviindus.in/static/superadmin/images_ex/up.png");
    var $uploadCrop5,
        tempFilename5,
        rawImg5,
        imageId5;

    function readFile5(input) {
        if (input.files && input.files[0]) {
            var reader = new FileReader();
            reader.onload = function (e) {
                $('.upload-demo5').addClass('ready');
                $('#cropImagePop5').modal('show');
                rawImg5 = e.target.result;
            }
            reader.readAsDataURL(input.files[0]);
        } else {
            swal("Sorry - you're browser doesn't support the FileReader API");
        }
    }

    $uploadCrop5 = $('#upload-demo5').croppie({
        viewport: {
            width: 80,
            height: 60,
        },
        enforceBoundary: false,
        enableExif: true
    });
    $('#cropImagePop5').on('shown.bs.modal', function () {
       
        $uploadCrop5.croppie('bind', {
            url: rawImg5
        }).then(function () {
            console.log('jQuery bind complete');
        });
    });

    $('.item-img5').on('change', function () {
        imageId5 = $(this).data('id');
        tempFilename5 = $(this).val();
        $('#cancelCropBtn5').data('id', imageId5);
        readFile5(this);
    });
    $('#cropImageBtn5').on('click', function (ev) {
        $uploadCrop5.croppie('result', {
            type: 'base64',
            format: 'png',
            size: {
                width: 80,
                height: 60
            }
        }).then(function (resp) {
            $('#item-img-output5').attr('src', resp);
            $('#cropped-img').val(resp);
            $('#cropImagePop5').modal('hide');
        });
    });
    // End upload preview image
</script>