{% extends "public_interface/layouts/public_base.html" %}
{% load static %}
{% load custom_filters %}
{% block content %}
  <div class="main-div pt-0 header-bg-transparent header-logo-white">
    <!-- career -->
    <section id="career" class="pt-0">
      <div class="banner-cover">
        <img class="img-primary"
             width=""
             height=""
             loading="lazy"
             alt="Career Banner"
             src="{% static 'public_interface/images/career/banner-cover/career-banner.jpeg' %}">
        <div class="caption w-100 text-center">
          <div class="wrapper">
            <div class="row text-white">
              <div class="col-12" data-aos="fade-down" data-aos-duration="2000">
                <h3 class="font-lnterbold">CAREER</h3>
                <h5 class="font-lnterbold">
                  <a href="{% url 'home' %}">Home</a>
                  <i class="fa fa-angle-right" aria-hidden="true"></i>
                  <a>Career</a>
                </h5>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="career-page">
        <div class="container-fluid common-padding">
          <div class="row">
            <div class="boxaa">
              <div class="row">
                <div class="twm-bnr-search-bar">
                  <form id="jobSearchForm">
                    <div class="row">
                      <!--Title-->
                      <div class="form-group col-xl-3 col-lg-6 col-md-12 col-12">
                        <label>Job Title</label>
                        <select class="select2 wt-search-bar-select" id="jobTitleSelect">
                          <option value="">Select an option</option>
                          {% for job in all_jobs %}<option value="{{ job.title }}">{{ job.title }}</option>{% endfor %}
                        </select>
                      </div>
                      <!--All Category-->
                      <div class="form-group col-xl-4 col-lg-6 col-md-12 col-12">
                        <label>Job Type</label>
                        <select class="select2 wt-search-bar-select" id="jobTypeSelect">
                          <option value="">Select an option</option>
                          <option value="Full Time">Full Time</option>
                          <option value="Part Time">Part Time</option>
                          <option value="Hybrid">Hybrid</option>
                          <option value="Remote">Remote</option>
                        </select>
                      </div>
                      <!--Location-->
                      <div class="form-group col-xl-3 col-lg-6 col-md-12 col-12">
                        <label>Location</label>
                        <select name="location" class="select2 wt-search-bar-select">
                          <option value="">Select Location</option>
                          {% for job in all_jobs %}<option value="{{ job.location }}">{{ job.location }}</option>{% endfor %}
                        </select>
                      </div>
                      <!--Find job btn-->
                      <div class="form-group col-xl-2 col-lg-6 col-md-12 col-12 text-end d-flex justify-content-md-center align-items-center">
                        <button type="button"
                                id="findJobButton"
                                class="site-button"
                                onclick="filtercareer()">Find Job</button>
                      </div>
                    </div>
                  </form>
                </div>
              </div>
            </div>
            <div class="box-bb mb-4" id="searchResults">
              {% for job in all_jobs %}
                <div class="row software-eng">
                  <div class="col-lg-8">
                    <h3 class="ctitle">{{ job.title }}</h3>
                    <div>
                      <div class="description line_2" id="desc{{ forloop.counter }}">{{ job.description|safe }}</div>
                      {% with description_length=job.description|length %}
                        <a href="#"
                           class="read-more-cnt"
                           id="readmore-btn{{ forloop.counter }}"
                           onclick="readmore('{{ forloop.counter }}')">Read More</a>
                      {% endwith %}
                    </div>
                    <div class="d-flex align-items-end">
                      <div class="location-box text-center">
                        <p class="loc">{{ job.location }}</p>
                      </div>
                      <div class="fes career-job-types ms-2 location-box"
                           data-types="{{ types_list|join:',' }}"></div>
                    </div>
                  </div>
                  <div class="col-lg-4 amount-k">
                    {% if job.salary %}
                      <h3>
                        {{ job.salary }} <span>/Year</span>
                      </h3>
                    {% else %}
                      <h3>Not Disclosed</h3>
                    {% endif %}
                    <button class="btn bg-blue text-white rounded-25 btn-zoom-hover font-lntermedium"
                            onclick="show_modal('{{ job.title }}')">Apply Now</button>
                  </div>
                </div>
              {% endfor %}
            </div>
          </div>
        </div>
      </div>
      <!-- career_modal -->
      <div class="modal fade modal-career"
           id="career_modal"
           tabindex="-1"
           aria-labelledby="exampleModalLabel"
           aria-hidden="true">
        <div class="modal-dialog modal-lg modal-dialog-centered">
          <div class="modal-content">
            <form method="post"
                  class="form"
                  enctype="multipart/form-data"
                  action="{% url 'job_email' %}"
                  id="careerform">
              {% csrf_token %}
              <div class="modal-header text-blue d-block text-center p-b-0 border-0">
                <h4 class="font-bold">JOB APPLICATION FORM</h4>
                <h6>Thank you for your interest in working with us.</h6>
                <button type="button"
                        class="btn text-blue btn-zoom-hover close-btn"
                        data-bs-dismiss="modal"
                        aria-label="Close">
                  <i class="fa fa-times-circle" aria-hidden="true"></i>
                </button>
              </div>
              <div class="modal-body">
                <div class="form-default">
                  <div class="form-body">
                    <div class="row justify-content-center">
                      {% if form.errors %}
                        <div class="col-lg-12">
                          <div class="alert alert-danger">
                            {% for error in form.non_field_errors %}<p>{{ error }}</p>{% endfor %}
                            {% for field in form %}
                              {% for error in field.errors %}<p>{{ field.label }}: {{ error }}</p>{% endfor %}
                            {% endfor %}
                          </div>
                        </div>
                      {% endif %}
                      {{ form.honey }}
                      <div class="col-lg-6">
                        <label class="form-label">{{ form.first_name.label }}</label>
                        {{ form.first_name }}
                      </div>
                      <div class="col-lg-6">
                        <label class="form-label">{{ form.last_name.label }}</label>
                        {{ form.last_name }}
                      </div>
                      <div class="col-lg-6">
                        <label class="form-label">{{ form.date_of_birth.label }}</label>
                        {{ form.date_of_birth }}
                      </div>
                      <div class="col-lg-6">
                        <label class="form-label">{{ form.email.label }}</label>
                        {{ form.email }}
                      </div>
                      <div class="col-lg-6">
                        <label class="form-label">{{ form.phone_number.label }}</label>
                        {{ form.phone_number }}
                      </div>
                      <div class="col-lg-6">
                        <label class="form-label">{{ form.linkedin_url.label }}</label>
                        {{ form.linkedin_url }}
                      </div>
                      <div class="col-lg-6">
                        <label class="form-label">{{ form.portfolio_url.label }}</label>
                        {{ form.portfolio_url }}
                      </div>
                      <div class="col-lg-6">
                        <label class="form-label">{{ form.notice_period.label }}</label>
                        {{ form.notice_period }}
                      </div>
                      <div class="col-lg-6">
                        <label class="form-label">{{ form.upload_cv.label }}</label>
                        <label class="attach-label-btn">
                          <div class="attach-label">Choose File*</div>
                          {{ form.upload_cv }}
                        </label>
                      </div>
                      <div class="col-lg-6">
                        <label class="form-label">{{ form.cover_letter.label }}</label>
                        <label class="attach-label-btn">
                          <div class="attach-label">Cover Letter</div>
                          {{ form.cover_letter }}
                        </label>
                      </div>
                      <div class="col-lg-12">
                        <label class="form-label">{{ form.message.label }}</label>
                        {{ form.message }}
                      </div>
                      <div class="col-lg-12">
                        <button type="submit"
                                class="btn bg-blue text-white rounded-25 min-width-100-px BTN_SUBMIT">
                          Submit Application
                        </button>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </form>
          </div>
        </div>
      </div>
    </section>
  </div>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.13/js/select2.min.js"></script>
  <script src="https://www.google.com/recaptcha/api.js?onload=onloadCallback&render=explicit"
          async
          defer></script>
  <script>
      // Initialize the selectpicker
      $(document).ready(function () {
        $('.selectpicker').selectpicker();
      });

      $(document).ready(function () {
        $(".select2").select2({
            placeholder: "Select an option"
        });

      });

      var onloadCallback = function () {
        grecaptcha.render('html_element', {
          'sitekey': ' 6LeIxAcTAAAAAJcZVRqyHh71UMIEGNQ_MXjiZKhI'
        });
      };

      function readmore(counter) {
        $("#desc" + counter).toggleClass("line_2");
        if ($("#desc" + counter).hasClass("line_2")) {
          $("#readmore-btn" + counter).html("Read More");
        } else {
          $("#readmore-btn" + counter).html("Read Less");
        }
      }
  </script>
{% endblock content %}
