{% load static %}
<div class="get-in-touch bg-x-light-blue padd_t_b_70">
    <div class="wrapper">
        <div class="row justify-content-center">
            <div class="col-lg-9">
                <div class="section-head text-center">
                    <h1 class="text-blue font-lnterbold">GET IN TOUCH</h1>
                </div>
                <div class="card mt-30" data-aos="fade-up" data-aos-duration="1000">
                    <form method="post"
                          class="form"
                          action="{% url 'enquiry' %}"
                          id="contact_form">
                        {% csrf_token %}
                        <div class="body">
                            <div class="row">
                                <div class="col-12">
                                    <input class="form-control text-blue"
                                           name="name"
                                           type="text"
                                           maxlength="50"
                                           placeholder="Your Name"
                                           required>
                                </div>
                                <div class="col-12">
                                    <input class="form-control text-blue"
                                           name="phone_number"
                                           type="text"
                                           maxlength="15"
                                           placeholder="Phone Number"
                                           required
                                           onkeypress="return event.charCode >= 48 && event.charCode <= 57">
                                        <input type="text" name="honey" class="d-none">
                                    </div>
                                    <div class="col-12" id="email">
                                        <input class="form-control text-blue"
                                               name="email"
                                               type="email"
                                               maxlength="100"
                                               placeholder="Email"
                                               required>
                                        <b><span class="text-danger formerror"></span></b>
                                    </div>
                                    <div class="col-12">
                                        <input class="form-control text-blue"
                                               name="location"
                                               type="text"
                                               maxlength="100"
                                               placeholder="Location"
                                               required>
                                    </div>
                                    <div class="col-12">
                                        <textarea class="form-control text-blue h-70-px"
                                                  name="message"
                                                  maxlength="500"
                                                  placeholder="Message"
                                                  required></textarea>
                                    </div>
                                </div>
                            </div>
                            <div class="foot text-center">
                                <button type="submit"
                                        id="submitButton"
                                        class="BTN_SUBMIT btn btn-primary font-lntermedium">Send Enquiry</button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div id="our_branches" class="branches padd_t_b_70">
        <div class="wrapper">
            <div class="row">
                <div class="col-12">
                    <div class="section-head">
                        <h1 class="text-blue font-lnterbold">OUR BRANCHES</h1>
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="col-lg-12">
                    <ul class="nav nav-tabs tab-country border-0 justify-content-center country_tab"
                        role="tablist">
                        <li class="nav-item" role="presentation">
                            <button class="nav-link  {% if branch == 'UAE' %}active{% endif %} info-item text-blue active"
                                    data-bs-toggle="tab"
                                    data-bs-target="#tab_uae"
                                    type="button"
                                    role="tab"
                                    aria-selected="true">
                                <div class="title a-item font-lnterbold">UAE</div>
                            </button>
                        </li>
                        <li class="nav-item" role="presentation">
                            <button class="nav-link {% if branch == 'KSA' %}active{% endif %} info-item text-blue"
                                    data-bs-toggle="tab"
                                    data-bs-target="#tab_ksa"
                                    type="button"
                                    role="tab"
                                    aria-selected="true">
                                <div class="title a-item font-lnterbold">KSA</div>
                            </button>
                        </li>
                        <li class="nav-item" role="presentation">
                            <button class="nav-link {% if branch == 'QATAR' %}active{% endif %} info-item text-blue"
                                    data-bs-toggle="tab"
                                    data-bs-target="#tab_qatar"
                                    type="button"
                                    role="tab"
                                    aria-selected="true">
                                <div class="title a-item font-lnterbold">QATAR</div>
                            </button>
                        </li>
                        <li class="nav-item" role="presentation">
                            <button class="nav-link {% if branch == 'OMAN' %}active{% endif %} info-item text-blue"
                                    data-bs-toggle="tab"
                                    data-bs-target="#tab_oman"
                                    type="button"
                                    role="tab"
                                    aria-selected="true">
                                <div class="title a-item font-lnterbold">OMAN</div>
                            </button>
                        </li>
                        <li class="nav-item" role="presentation">
                            <button class="nav-link {% if branch == 'INDIA' %}active{% endif %} info-item text-blue"
                                    data-bs-toggle="tab"
                                    data-bs-target="#tab_india"
                                    type="button"
                                    role="tab"
                                    aria-selected="true">
                                <div class="title a-item font-lnterbold">INDIA</div>
                            </button>
                        </li>
                        <li class="nav-item" role="presentation">
                            <button class="nav-link info-item text-blue"
                                    data-bs-toggle="tab"
                                    data-bs-target="#tab_uk"
                                    type="button"
                                    role="tab"
                                    aria-selected="true">
                                <div class="title a-item font-lnterbold">UNITED KINGDOM</div>
                            </button>
                        </li>
                        <li class="nav-item" role="presentation">
                            <button class="nav-link info-item text-blue"
                                    data-bs-toggle="tab"
                                    data-bs-target="#tab_ml"
                                    type="button"
                                    role="tab"
                                    aria-selected="true">
                                <div class="title a-item font-lnterbold">Maldives</div>
                            </button>
                        </li>
                    </ul>
                </div>
                {% include "public_interface/components/contact/address_map.html" %}
            </div>
        </div>
    </div>
    <!-- Modal -->
    <div class="modal fade" id="responseModal" tabindex="-1">
        <div class="modal-dialog position-absolute top-0 end-0 m-3 rounded-5 shadow-lg">
            <div class="modal-content">
                <div class="modal-header p-2">
                    <h6 class="modal-title"></h6>
                    <button type="button"
                            class="btn-close"
                            data-bs-dismiss="modal"
                            aria-label="Close"></button>
                </div>
                <div class="modal-body p-2"></div>
            </div>
        </div>
    </div>
    <script>
        $(document).ready(function () {
          const responseModal = new bootstrap.Modal(document.getElementById('responseModal'));
      
          $("#contact_form").submit(function (event) {
            event.preventDefault();
            const $form = $(this);
      
            $.ajax({
              type: "POST",
              url: $form.attr('action'),
              data: $form.serialize(),
              success: function (response) {
                showModal("Success", "Enquiry submitted successfully!", "success");
                $form[0].reset();
              },
              error: function (xhr) {
                const errorMessage = JSON.parse(xhr.responseText).message || "An error occurred.";
                showModal("Error", errorMessage, "danger");
              }
            });
          });
      
          function showModal(title, message, type) {
            const modal = $('#responseModal');
            const alertHTML = `${message}`;
      
            modal.find('.modal-header')
              .removeClass('bg-success bg-danger text-white')
              .addClass(type === 'success' ? 'bg-success text-white' : 'bg-danger text-white');
      
            modal.find('.modal-title').text(title);
            modal.find('.modal-body').html(alertHTML);
      
            responseModal.show();
      
            setTimeout(() => {
              responseModal.hide();
            }, 5000);
          }
        });
    </script>
